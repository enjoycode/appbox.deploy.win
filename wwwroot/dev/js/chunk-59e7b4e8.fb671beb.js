(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59e7b4e8"],{4016:function(e,t,n){},"5dde":function(e,t,n){},"65c3":function(e,t,n){"use strict";var i=n("b5e5"),r=n.n(i);r.a},b5e5:function(e,t,n){},d5bf:function(e,t,n){"use strict";var i=n("4016"),r=n.n(i);r.a},e551:function(e,t,n){"use strict";var i=n("5dde"),r=n.n(i);r.a},f1b0:function(e,t,n){"use strict";n.r(t);var i,r,a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%"}},[n("div",{staticClass:"header"},[n("el-radio-group",{staticStyle:{"margin-left":"40px"},attrs:{fill:"#0994ff",size:"small"},model:{value:e.activeView,callback:function(t){e.activeView=t},expression:"activeView"}},e._l(e.views,(function(t){return n("el-radio-button",{key:t.label,attrs:{label:t.label}},[e._v(e._s(t.title))])})),1),e._v(" "),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Insert"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"ICL"}},[e._v("Column Left")]),n("el-dropdown-item",{attrs:{command:"ICR"}},[e._v("Column Right")]),n("el-dropdown-item",{attrs:{command:"IRA",divided:""}},[e._v("Row Above")]),n("el-dropdown-item",{attrs:{command:"IRB"}},[e._v("Row Below")])],1)],1),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Delete"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"DC"}},[e._v("Column")]),n("el-dropdown-item",{attrs:{command:"DR"}},[e._v("Row")])],1)],1),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Cells"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"CM"}},[e._v("Merge")]),n("el-dropdown-item",{attrs:{command:"CS"}},[e._v("Split")])],1)],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],attrs:{size:"small",icon:"fas fa-times fa-fw"},on:{click:e.onDeleteSelection}},[e._v("Delete Selection")])],1),n("div",{staticClass:"content"},[n("design-view",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],ref:"designView",attrs:{background:"lightgray"},on:{ready:e.onDesignViewReady}}),"preview"===e.activeView?n("pdf-viewer",{attrs:{file:"/api/design/report/"+e.target.ID}}):e._e()],1)])},o=[],s=n("c34c"),l=(n("ac4d"),n("8a81"),n("ac6a"),n("d225")),u=n("b0b4"),d=n("2de8"),c=n("308d"),h=n("6bb5"),f=n("013f"),m=n("4e2b"),g=n("ffb8"),v=n("a374"),y=n("fe0c"),p=n("1fb1"),b=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(c["a"])(this,Object(h["a"])(t).apply(this,arguments)),e.anchorSize=6,e.anchorLocation=p["a"].None,e}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"OnRender",value:function(e){e.strokeStyle="darkgray",e.lineWidth=2,e.strokeRect(-3,-3,this.Target.Bounds.Width+6,this.Target.Bounds.Height+6),this.DrawAnchor(e,this.BottomCenter)}},{key:"DrawAnchor",value:function(e,t){e.fillStyle="white",e.fillRect(t.X,t.Y,t.Width,t.Height),e.strokeStyle="black",e.lineWidth=1,e.strokeRect(t.X,t.Y,t.Width,t.Height)}},{key:"HitTest",value:function(e){var t="";return this.BottomCenter.Contains(e.X,e.Y)?(this.anchorLocation=p["a"].BottomCenter,t="s-resize"):this.anchorLocation=p["a"].None,this.anchorLocation!=p["a"].None?[!0,t]:[!1,t]}},{key:"OnMouseMove",value:function(e){this.Target.Resize(this.anchorLocation,e.DeltaX,e.DeltaY)}},{key:"OnMouseUp",value:function(e){this.Target.OnEndResize()}},{key:"BottomCenter",get:function(){return new v["a"]((this.Target.Bounds.Width-this.anchorSize)/2,this.Target.Bounds.Height,this.anchorSize,this.anchorSize)}}]),t}(y["a"]),_=n("b7c5"),w=n("8500"),N=n("a2ee"),C=n("26e6"),S=function(e){function t(e,n,i){var r;Object(l["a"])(this,t),r=Object(c["a"])(this,Object(h["a"])(t).call(this,e)),r._bounds=new v["a"](0,0,0,0);var a=N["a"].TryGetSize(r.xmlNode,"Height",200);r._bounds=new v["a"](0,i,n,a);var o=N["a"].GetNamedChildNode(r.xmlNode,"ReportItems");if(o){var s=!0,u=!1,d=void 0;try{for(var f,m=o.childNodes[Symbol.iterator]();!(s=(f=m.next()).done);s=!0){var g=f.value;if(g.nodeType===Node.ELEMENT_NODE){var y=C["a"].Make(g,null);y&&r.AddItem(y)}}}catch(p){u=!0,d=p}finally{try{s||null==m.return||m.return()}finally{if(u)throw d}}}return r}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"SetBounds",value:function(e,t,n,i,r){if(r===_["a"].Height){var a=i-this._bounds.Height;if(this.Parent){this._bounds.Height=i;for(var o=-1,s=0;s<this.Parent.Items.length;s++){var l=this.Parent.Items[s];-1===o&&l===this&&(o=s),-1!==o&&s>o&&(l.Bounds.Y+=a)}this.Parent.Bounds.Height+=a}this.Surface&&this.Surface.Invalidate()}else console.warn("ReportSectionDesigner只支持设置高度值")}},{key:"OnEndResize",value:function(){this.SetPropertyRSize("Height",this.Bounds.Height),this.Surface&&this.Surface.PropertyPanel.refreshProperty("Height")}},{key:"Paint",value:function(e){if(e.save(),e.beginPath(),e.rect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.clip(),e.fillStyle="white",e.fillRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.strokeStyle="rgb(173,219,241)",e.lineWidth=1,e.strokeRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),this.Items){e.translate(this.Bounds.X,this.Bounds.Y);var t=!0,n=!1,i=void 0;try{for(var r,a=this.Items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;o.Paint(e)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}e.translate(-this.Bounds.X,-this.Bounds.Y)}e.restore()}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Height",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("Height","0mm")},setter:function(t){return e.SetPropertyRSize("Height",t)}}]}];return"Body"!==this.getPropertyOwnerType()&&(t[0].items.push({title:"PrintOnFirstPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnFirstPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnFirstPage",t)}}),t[0].items.push({title:"PrintOnLastPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnLastPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnLastPage",t)}})),t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){this.SetBounds(e.X,e.Y,e.Width,e.Height,_["a"].All)}},{key:"IsContainer",get:function(){return!0}},{key:"Behavior",get:function(){return w["a"].CanResize}},{key:"SelectionAdorner",get:function(){return!this._selectionAdorner&&this.Surface&&(this._selectionAdorner=new b(this.Surface.Adorners,this)),this._selectionAdorner}}]),t}(g["a"]);(function(e){e[e["DataField"]=0]="DataField",e[e["EntityRef"]=2]="EntityRef",e[e["EntitySet"]=3]="EntitySet"})(i||(i={})),function(e){e[e["EntityId"]=0]="EntityId",e[e["String"]=1]="String",e[e["DateTime"]=2]="DateTime",e[e["UInt16"]=3]="UInt16",e[e["Int16"]=4]="Int16",e[e["UInt32"]=5]="UInt32",e[e["Int32"]=6]="Int32",e[e["UInt64"]=7]="UInt64",e[e["Int64"]=8]="Int64",e[e["Decimal"]=9]="Decimal",e[e["Boolean"]=10]="Boolean",e[e["Guid"]=11]="Guid",e[e["Byte"]=12]="Byte",e[e["Binary"]=13]="Binary",e[e["Enum"]=14]="Enum",e[e["Float"]=15]="Float",e[e["Double"]=16]="Double"}(r||(r={}));var D=function(){function e(t,n){Object(l["a"])(this,e),this._owner=t,this._node=n}return Object(u["a"])(e,[{key:"getPropertyOwnerType",value:function(){return"Field"}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Name",readonly:!1,editor:"TextBox",getter:function(){return e.Name},setter:function(t){e.Name=t}},{title:"DataField",readonly:!1,editor:"TextBox",getter:function(){return e.DataField},setter:function(t){e.DataField=t}},{title:"TypeName",readonly:!1,editor:"Select",options:I.TypeNames,getter:function(){return e.TypeName},setter:function(t){e.TypeName=t}}]}];return t}},{key:"Node",get:function(){return this._node}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"DataField",get:function(){var e=N["a"].GetNamedChildNode(this._node,"DataField");return e?e.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"DataField");t.textContent=e}},{key:"TypeName",get:function(){var e=N["a"].GetNamedChildNode(this._node,"TypeName");return e?e.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"TypeName");t.textContent=e}}]),e}(),k=function(){function e(t){Object(l["a"])(this,e),this._node=t}return Object(u["a"])(e,[{key:"CommandText",get:function(){var e=N["a"].GetNamedChildNode(this._node,"CommandText");return e?e.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"CommandText");t.textContent=e}}]),e}(),x=function(){function e(t,n){if(Object(l["a"])(this,e),this._fields=[],this._owner=t,this._node=n,this.Query=new k(N["a"].GetOrCreateChildNode(this._node,"Query")),this._fieldsNode=N["a"].GetNamedChildNode(this._node,"Fields"),this._fieldsNode){var i=!0,r=!1,a=void 0;try{for(var o,s=this._fieldsNode.childNodes[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var u=o.value;u.nodeType===Node.ELEMENT_NODE&&this._fields.push(new D(this,u))}}catch(d){r=!0,a=d}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}}}return Object(u["a"])(e,[{key:"AddField",value:function(e,t,n){this._fieldsNode||(this._fieldsNode=N["a"].CreateChildNode(this._node,"Fields"));var i=N["a"].CreateChildNode(this._fieldsNode,"Field"),r=new D(this,i);r.Name=e,r.DataField=t,r.TypeName=n,this._fields.push(r)}},{key:"RemoveField",value:function(e){this._fieldsNode.removeChild(e.Node),this._fields.splice(this._fields.indexOf(e),1),0===this._fields.length&&(this._node.removeChild(this._fieldsNode),this._fieldsNode=null)}},{key:"getPropertyOwnerType",value:function(){return"DataSet"}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Name",readonly:!1,editor:"TextBox",getter:function(){return e.Name},setter:function(t){e.Name=t}},{title:"QueryCommand",readonly:!1,editor:"TextBox",getter:function(){return e.QueryCommand},setter:function(t){e.QueryCommand=t}}]}];return t}},{key:"Node",get:function(){return this._node}},{key:"Fields",get:function(){return this._fields}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"QueryCommand",get:function(){return this.Query.CommandText},set:function(e){this.Query.CommandText=e}}]),e}(),I=function(){function e(t){if(Object(l["a"])(this,e),this._items=[],this._owner=t,this._node=N["a"].GetNamedChildNode(t.XmlNode,"DataSets"),this._node){var n=!0,i=!1,r=void 0;try{for(var a,o=this._node.childNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.nodeType===Node.ELEMENT_NODE&&this._items.push(new x(this,s))}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}}}return Object(u["a"])(e,[{key:"Add",value:function(t,n){this._node||(this._node=N["a"].CreateChildNode(this._owner.XmlNode,"DataSets"));var r=N["a"].CreateChildNode(this._node,"DataSet"),a=new x(this,r);if(t&&(a.Name=t),n){var o=!0,s=!1,l=void 0;try{for(var u,d=n[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var c=u.value;c.Type===i.DataField&&a.AddField(c.Name,c.Name,e.ToTypeName(c.DataType))}}catch(h){s=!0,l=h}finally{try{o||null==d.return||d.return()}finally{if(s)throw l}}}this._items.push(a)}},{key:"Remove",value:function(e){this._node.removeChild(e.Node),this._items.splice(this._items.indexOf(e),1),0===this._items.length&&(this._owner.XmlNode.removeChild(this._node),this._node=null)}},{key:"GetNames",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,a=this._items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;e.push(o.Name)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return e}},{key:"Items",get:function(){return this._items}}],[{key:"ToTypeName",value:function(e){switch(e){case r.Enum:return"Int32";case r.String:return"String";case r.Boolean:return"Boolean";case r.DateTime:return"DateTime";case r.Decimal:return"Decimal";case r.Byte:return"Byte";case r.Int16:return"Int16";case r.Int32:return"Int32";case r.Int64:return"Int64";case r.UInt16:return"UInt16";case r.UInt32:return"UInt32";case r.UInt64:return"UInt64";case r.Float:return"Float";case r.Double:return"Double";default:return"Object"}}}]),e}();I.TypeNames=["String","Boolean","DateTime","Decimal","Byte","Int16","Int32","Int64","UInt16","UInt32","UInt64","Float","Double"];var P=function(){function e(t,n){Object(l["a"])(this,e),this._owner=t,this._node=n}return Object(u["a"])(e,[{key:"Node",get:function(){return this._node}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"MIMEType",get:function(){var e=N["a"].GetNamedChildNode(this._node,"MIMEType");return e?e.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"MIMEType");t.textContent=e}},{key:"ImageData",get:function(){var e=N["a"].GetNamedChildNode(this._node,"ImageData");return e?e.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"ImageData");t.textContent=e}},{key:"Image",get:function(){return"data:"+this.MIMEType+";base64,"+this.ImageData}}]),e}(),O=function(){function e(t){if(Object(l["a"])(this,e),this._items=[],this._owner=t,this._node=N["a"].GetNamedChildNode(t.XmlNode,"EmbeddedImages"),this._node){var n=!0,i=!1,r=void 0;try{for(var a,o=this._node.childNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.nodeType===Node.ELEMENT_NODE&&this._items.push(new P(this,s))}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}}}return Object(u["a"])(e,[{key:"Add",value:function(e,t){var n=t.indexOf(":"),i=t.indexOf(";"),r=t.substring(n+1,i),a=t.indexOf(","),o=t.substring(a+1);this._node||(this._node=N["a"].CreateChildNode(this._owner.XmlNode,"EmbeddedImages"));var s=N["a"].CreateChildNode(this._node,"EmbeddedImage"),l=new P(this,s);l.Name=e,l.MIMEType=r,l.ImageData=o,this._items.push(l)}},{key:"Remove",value:function(e){this._node.removeChild(e.Node),this._items.splice(this._items.indexOf(e),1),0===this._items.length&&(this._owner.XmlNode.removeChild(this._node),this._node=null)}},{key:"GetNames",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,a=this._items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;e.push(o.Name)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return e}},{key:"GetImageData",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,a=this._items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;if(o.Name===e)return o.Image}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}},{key:"Items",get:function(){return this._items}}]),e}(),T=function(){function e(t,n){Object(l["a"])(this,e),this._owner=t,this._node=n}return Object(u["a"])(e,[{key:"getPropertyOwnerType",value:function(){return"Parameter"}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Name",readonly:!1,editor:"TextBox",getter:function(){return e.Name},setter:function(t){e.Name=t}},{title:"DataType",readonly:!1,editor:"Select",options:I.TypeNames,getter:function(){return e.DataType},setter:function(t){e.DataType=t}},{title:"DefaultValue",readonly:!1,editor:"TextBox",getter:function(){return e.DefaultValue},setter:function(t){e.DefaultValue=t}}]}];return t}},{key:"Node",get:function(){return this._node}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"DataType",get:function(){var e=N["a"].GetNamedChildNode(this._node,"DataType");return e?e.textContent:"String"},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"DataType");t.textContent=e}},{key:"DefaultValue",get:function(){var e=N["a"].GetNamedChildNode(this._node,"DefaultValue");if(!e)return"";var t=N["a"].GetNamedChildNode(e,"Values");if(!t)return"";var n=N["a"].GetNamedChildNode(t,"Value");return n?n.textContent:""},set:function(e){var t=N["a"].GetOrCreateChildNode(this._node,"DefaultValue"),n=N["a"].GetOrCreateChildNode(t,"Values"),i=N["a"].GetOrCreateChildNode(n,"Value");i.textContent=e}}]),e}(),B=function(){function e(t){if(Object(l["a"])(this,e),this._items=[],this._owner=t,this._node=N["a"].GetNamedChildNode(t.XmlNode,"ReportParameters"),this._node){var n=!0,i=!1,r=void 0;try{for(var a,o=this._node.childNodes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.nodeType===Node.ELEMENT_NODE&&this._items.push(new T(this,s))}}catch(u){i=!0,r=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}}}return Object(u["a"])(e,[{key:"Add",value:function(e){this._node||(this._node=N["a"].CreateChildNode(this._owner.XmlNode,"ReportParameters"));var t=N["a"].CreateChildNode(this._node,"ReportParameter"),n=new T(this,t);n.Name=e,n.DataType="String",this._items.push(n)}},{key:"Remove",value:function(e){this._node.removeChild(e.Node),this._items.splice(this._items.indexOf(e),1),0===this._items.length&&(this._owner.XmlNode.removeChild(this._node),this._node=null)}},{key:"GetNames",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,a=this._items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;e.push(o.Name)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return e}},{key:"Items",get:function(){return this._items}}]),e}(),R=function(e){function t(e){var n;Object(l["a"])(this,t),n=Object(c["a"])(this,Object(h["a"])(t).call(this,e)),n._bounds=new v["a"](0,0,0,0),n._datasets=new I(Object(f["a"])(n));var i=0,r=N["a"].TryGetSize(n.xmlNode,"PageWidth",400),a=N["a"].GetNamedChildNode(n.xmlNode,"PageHeader");if(a){var o=new S(a,r,i);n.AddItem(o),i+=o.Bounds.Height}var s=N["a"].GetNamedChildNode(n.xmlNode,"Body");if(s){var u=new S(s,r,i);n.AddItem(u),i+=u.Bounds.Height}var d=N["a"].GetNamedChildNode(n.xmlNode,"PageFooter");if(d){var m=new S(d,r,i);n.AddItem(m),i+=m.Bounds.Height}return n._bounds=new v["a"](8,8,r,i),n}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"SetBounds",value:function(e,t,n,i,r){}},{key:"Paint",value:function(e){if(this.Items){var t=!0,n=!1,i=void 0;try{for(var r,a=this.Items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;o.Paint(e)}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}}}},{key:"OnChangePageWidth",value:function(e){this._bounds.Width=N["a"].SizeToPixel(e);var t=!0,n=!1,i=void 0;try{for(var r,a=this.Items[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;o.Bounds.Width=this._bounds.Width}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}this.Surface.Invalidate()}},{key:"OnChangePageHeight",value:function(e){}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"PageWidth",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageWidth","200mm")},setter:function(t){e.SetPropertyRSize("PageWidth",t),e.OnChangePageWidth(t)}},{title:"PageHeight",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageHeight","150mm")},setter:function(t){e.SetPropertyRSize("PageHeight",t),e.OnChangePageHeight(t)}},{title:"Parameters",readonly:!0,editor:"ReportParameters",getter:function(){return e},setter:function(e){}},{title:"DataSets",readonly:!0,editor:"ReportDataSets",getter:function(){return e},setter:function(e){}},{title:"EmbeddedImages",readonly:!0,editor:"ReportEmbeddedImages",getter:function(){return e},setter:function(e){}}]}];return t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){}},{key:"IsContainer",get:function(){return!0}},{key:"DataSets",get:function(){return this._datasets}},{key:"Parameters",get:function(){return this._parameters||(this._parameters=new B(this)),this._parameters}},{key:"EmbeddedImages",get:function(){return this._embeddedImages||(this._embeddedImages=new O(this)),this._embeddedImages}}]),t}(g["a"]),E=n("8cde"),j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-input",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},V=[],$={props:{target:{type:Object}},data:function(){return{value:""}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},A=$,F=n("2877"),G=Object(F["a"])(A,j,V,!1,null,null,null),H=G.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-checkbox",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},z=[],L={props:{target:{type:Object}},data:function(){return{value:!1}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},W=L,X=Object(F["a"])(W,M,z,!1,null,null,null),U=X.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.target.options,(function(e){return n("el-option",{key:e,attrs:{value:e}})})),1)},Q=[],J={props:{target:{type:Object}},data:function(){return{value:""}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},q=J,K=Object(F["a"])(q,Y,Q,!1,null,null,null),Z=K.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-color-picker",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},te=[],ne={props:{target:{type:Object}},data:function(){return{value:"#000000"}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},ie=ne,re=Object(F["a"])(ie,ee,te,!1,null,null,null),ae=re.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:e.openEditor}},[e._v("...")]),n("el-dialog",{attrs:{"before-close":e.closingEditor,title:"Report Parameters",visible:e.dlgVisible,width:"600px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"New Parameter Name"},model:{value:e.newParameterName,callback:function(t){e.newParameterName=t},expression:"newParameterName"}}),n("el-button-group",[n("el-button",{on:{click:e.onAdd}},[e._v("Add")]),n("el-button",{on:{click:e.onDel}},[e._v("Remove")])],1),e._v(" "),n("br"),n("br"),n("el-row",{staticStyle:{height:"260px"}},[n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("el-table",{attrs:{data:e.parameters,"highlight-current-row":"",border:"",size:"mini","empty-text":" ",height:"100%"},on:{"current-change":e.onCurrentChange}},[n("el-table-column",{attrs:{prop:"Name",label:"Name"}}),n("el-table-column",{attrs:{prop:"DataType",label:"DataType"}})],1)],1),n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("property-panel",{ref:"props"})],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},se=[],le=n("eb37"),ue=n("ff57"),de={components:{PropertyPanel:le["a"]},props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,newParameterName:"",currentRow:null,parameters:[],treeOpts:{label:"Name",children:"Fields"}}},watch:{target:function(e){this.value=e.getter()}},methods:{openEditor:function(){this.dlgVisible=!0,this.$set(this,"parameters",this.value.Parameters.Items)},closingEditor:function(e){e()},onAdd:function(){this.value.Parameters.Add(this.newParameterName),this.newParameterName=""},onDel:function(){this.currentRow?(this.value.Parameters.Remove(this.currentRow),this.currentRow=null,this.$refs.props.setPropertyOwner(null)):this.$message.warning("Please select a Parameter first")},onCurrentChange:function(e){this.currentRow=e,this.$refs.props.DesignService||(this.$refs.props.DesignService=this.value.Surface.DesignService),this.$refs.props.setPropertyOwner(e)}},mounted:function(){this.value=this.target.getter()}},ce=de,he=Object(F["a"])(ce,oe,se,!1,null,null,null),fe=he.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:e.openEditor}},[e._v("...")]),n("el-dialog",{attrs:{"before-close":e.closingEditor,title:"Report DataSets",visible:e.dlgVisible,width:"600px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",[n("el-select",{attrs:{"value-key":"ID",filterable:"",placeholder:" "},model:{value:e.entityModel,callback:function(t){e.entityModel=t},expression:"entityModel"}},e._l(e.allEntities,(function(t){return n("el-option-group",{key:t.ID,attrs:{label:t.Text,value:t.ID}},e._l(t.Nodes,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e}})})),1)})),1),n("el-button-group",[n("el-button",{on:{click:e.onAddDS}},[e._v("Add")]),n("el-button",{on:{click:e.onDelDS}},[e._v("Remove")])],1),e._v(" "),n("el-button-group",[n("el-button",{on:{click:e.onAddField}},[e._v("Add Field")]),n("el-button",{on:{click:e.onDelField}},[e._v("Remove Field")])],1),n("br"),n("br"),n("el-row",{staticStyle:{height:"260px"}},[n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("el-tree",{staticStyle:{height:"100%"},attrs:{data:e.datasets,props:e.treeOpts,"highlight-current":"","default-expand-all":""},on:{"current-change":e.onCurrentChange}})],1),n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("property-panel",{ref:"props"})],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},ge=[],ve={components:{PropertyPanel:le["a"]},props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,allEntities:[],entityModel:null,currentNode:null,datasets:[],treeOpts:{label:"Name",children:"Fields"}}},watch:{target:function(e){this.value=e.getter()}},methods:{openEditor:function(){this.dlgVisible=!0,this.$set(this,"datasets",this.value.DataSets.Items)},closingEditor:function(e){e()},onAddDS:function(){var e=this,t=this;this.entityModel&&$runtime.channel.invoke("sys.DesignService.GetEntityModel",[this.entityModel.ID]).then((function(n){t.value.DataSets.Add(e.entityModel.Name,n.Members)})).catch((function(e){console.warn(e)}))},onDelDS:function(){this.currentNode&&1===this.currentNode.level?(this.value.DataSets.Remove(this.currentNode.data),this.currentNode=null,this.$refs.props.setPropertyOwner(null)):this.$message.warning("Please select a DataSet first")},onAddField:function(){var e=this;this.currentNode&&1===this.currentNode.level?this.$prompt("DataField Name","Input",{confirmButtonText:"Ok",cancelButtonText:"Cancel"}).then((function(t){var n=t.value;e.currentNode.data.AddField(n,n,"String")})).catch((function(){})):this.$message.warning("Please select a DataSet first")},onDelField:function(){this.currentNode&&2===this.currentNode.level?(this.currentNode.parent.data.RemoveField(this.currentNode.data),this.currentNode=null,this.$refs.props.setPropertyOwner(null)):this.$message.warning("Please select a Field first")},onCurrentChange:function(e,t){this.currentNode=t,this.$refs.props.DesignService||(this.$refs.props.DesignService=this.value.Surface.DesignService),this.$refs.props.setPropertyOwner(e)}},mounted:function(){this.value=this.target.getter(),ue["a"].tree.getAllEntityNodes(this.allEntities,null)}},ye=ve,pe=Object(F["a"])(ye,me,ge,!1,null,null,null),be=pe.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:function(t){e.dlgVisible=!0}}},[e._v("...")]),n("el-dialog",{attrs:{title:"Border Style",visible:e.dlgVisible,width:"400px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",{staticClass:"rows"},e._l(e.borders,(function(t){return n("el-row",{key:t.pos,attrs:{gutter:8}},[n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v(e._s(t.pos)+":")]),n("el-col",{attrs:{span:8}},[n("el-select",{on:{change:function(n){return e.changeStyle("BorderStyle",t)}},model:{value:t.style,callback:function(n){e.$set(t,"style",n)},expression:"item.style"}},e._l(e.borderStyles,(function(e){return n("el-option",{key:e,attrs:{value:e}})})),1)],1),n("el-col",{attrs:{span:10}},[n("el-input-number",{attrs:{min:0,max:20},on:{change:function(n){return e.changeStyle("BorderWidth",t)}},model:{value:t.width,callback:function(n){e.$set(t,"width",n)},expression:"item.width"}})],1),n("el-col",{attrs:{span:2}},[n("el-color-picker",{on:{change:function(n){return e.changeStyle("BorderColor",t)}},model:{value:t.color,callback:function(n){e.$set(t,"color",n)},expression:"item.color"}})],1)],1)})),1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},we=[],Ne={props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,borderStyles:["None","Dotted","Dashed","Solid"],borders:[]}},watch:{target:function(e){this.refresh()}},methods:{refresh:function(){this.value=this.target.getter(),this.$set(this,"borders",this.value.BorderStyles)},changeStyle:function(e,t){this.value.SetBorderStyle(e,t)}},mounted:function(){this.refresh()}},Ce=Ne,Se=(n("d5bf"),Object(F["a"])(Ce,_e,we,!1,null,"69be714a",null)),De=Se.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:e.openEditor}},[e._v("...")]),n("el-dialog",{attrs:{"before-close":e.closingEditor,title:"Report Embedded Images",visible:e.dlgVisible,width:"600px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",{staticClass:"rows"},[n("el-row",{attrs:{gutter:5}},e._l(e.images,(function(t){return n("el-col",{key:t.Name,attrs:{span:8}},[n("el-card",{attrs:{"body-style":{padding:"0px"}}},[n("el-image",{staticStyle:{height:"120px"},attrs:{src:t.Image,fit:"contain"}}),n("div",{staticStyle:{padding:"14px"}},[n("el-input",{model:{value:t.Name,callback:function(n){e.$set(t,"Name",n)},expression:"img.Name"}}),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.onDel(t)}}},[e._v("Remove")])],1)],1)],1)})),1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("input",{ref:"input",staticStyle:{width:"0px",visibility:"hidden"},attrs:{multiple:!1,accept:".png,.jpg,.webp",type:"file"},on:{change:e.onFileChange}}),n("el-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("Add")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},xe=[],Ie=(n("7f7f"),n("28a5"),{components:{PropertyPanel:le["a"]},props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,images:[]}},watch:{target:function(e){this.value=e.getter()}},methods:{openEditor:function(){this.dlgVisible=!0,this.$set(this,"images",this.value.EmbeddedImages.Items)},closingEditor:function(e){e()},onAdd:function(){this.$refs.input.value=null,this.$refs.input.click()},onFileChange:function(e){var t=e.target||window.event.srcElement,n=t.files;if(FileReader&&n&&n.length){var i=n[0].name.split(".").slice(0,-1).join("."),r=new FileReader,a=this;r.onload=function(){a.value.EmbeddedImages.Add(i,r.result)},r.readAsDataURL(n[0])}else this.$message.warning("Can't read image file.")},onDel:function(e){this.value.EmbeddedImages.Remove(e)}},mounted:function(){this.value=this.target.getter()}}),Pe=Ie,Oe=(n("e551"),Object(F["a"])(Pe,ke,xe,!1,null,"17b33614",null)),Te=Oe.exports,Be=function(){function e(t,n,i){Object(l["a"])(this,e),this._surface=t,this._channel=n,this._modelId=i,this._surface.DesignService=this,this._surface.ToolboxService.Toolbox=new E["a"],this._surface.PropertyPanel.DesignService=this}return Object(u["a"])(e,[{key:"GetXmlString",value:function(){var e=this._rootDesigner.XmlNode.ownerDocument;return(new XMLSerializer).serializeToString(e)}},{key:"LoadDesigners",value:function(e){var t=N["a"].LoadXMLString(e),n=t.getElementsByTagName("Report")[0],i=new R(n);this._rootDesigner=i,this._surface.AddItem(this._rootDesigner),this._surface.PropertyPanel.setPropertyOwner(this._rootDesigner),this._surface.Invalidate()}},{key:"ChangeProperty",value:function(e,t,n,i){console.log("ReportDesignService.ChangeProperty: "+t,i)}},{key:"DeleteSelection",value:function(){var e=this._surface.SelectionService.SelectedItems;if(e&&0!==e.length){var t=!0,n=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;o instanceof d["a"]&&!o.IsTableCell&&(o.Parent?o.Parent.RemoveItem(o):console.warn("待删除的元素无上级"))}}catch(s){n=!0,i=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}this._surface.SelectionService.ClearSelection()}}},{key:"InsertColumn",value:function(e){var t=this._surface.SelectionService.SelectedItems;if(0===t.length||!(t[0]instanceof d["a"])||!t[0].IsTableCell)return"Please select some TableCell first.";var n=t[0],i=n.Cell.Row,r=n.Cell.ColIndex;e||r++,i.Owner.Table.InsertColumn(r,100),i.Owner.Table.Parent.Invalidate()}},{key:"DeleteColumn",value:function(){var e=this._surface.SelectionService.SelectedItems;if(0===e.length||!(e[0]instanceof d["a"])||!e[0].IsTableCell)return"Please select some TableCell first.";var t=e[0],n=t.Cell.Row.Owner.Table;if(1===n.Columns.length)return"Cann't delete last column.";var i=t.Cell.ColIndex;t.Cell.Row.Owner.Table.DeleteColumn(i),n.Parent.Invalidate()}},{key:"GetShapes",value:function(){return[]}},{key:"GetConnections",value:function(){return[]}},{key:"GetPropertyEditor",value:function(t){return e._editors[t]}},{key:"Surface",get:function(){return this._surface}},{key:"RootDesigner",get:function(){return this._rootDesigner}}]),e}();Be._editors={TextBox:H,CheckBox:U,Select:Z,Color:ae,ReportParameters:fe,ReportDataSets:be,ReportEmbeddedImages:Te,BorderStyle:De};var Re={components:{DesignView:s["a"]},props:{target:{type:Object,required:!0}},data:function(){return{activeView:"design",views:[{label:"design",title:"Design"},{label:"preview",title:"Preview"}],designerType:"ReportDesigner",designService:null}},methods:{onDesignViewReady:function(){if(this.designService=new Be(this.$refs.designView.designSurface,$runtime.channel,this.target.ID),0===this.target.ID){var e="<Report>";return e+="<PageWidth>200mm</PageWidth>",e+="<PageHeight>140mm</PageHeight>",e+="<PageHeader>",e+="<Height>20mm</Height>",e+="<ReportItems>",e+='<Textbox Name="Textbox1">',e+="<Left>50pt</Left>",e+="<Top>10pt</Top>",e+="<Width>100pt</Width>",e+="<Height>30pt</Height>",e+="<Value>测试报表 Hello Future! 1234567890</Value>",e+="</Textbox>",e+="</ReportItems>",e+="</PageHeader>",e+="<Body>",e+="<Height>40mm</Height>",e+="</Body>",e+="<PageFooter>",e+="<Height>15mm</Height>",e+="</PageFooter>",e+="</Report>",void this.designService.LoadDesigners(e)}var t=this;$runtime.channel.invoke("sys.DesignService.OpenReportModel",[this.target.ID]).then((function(e){t.designService.LoadDesigners(e)})).catch((function(e){t.$message.error("Open Report error:"+e)}))},onTableCommand:function(e){var t=null;switch(e){case"ICL":t=this.designService.InsertColumn(!0);break;case"ICR":t=this.designService.InsertColumn(!1);break;case"DC":t=this.designService.DeleteColumn();break;default:break}t&&this.$message.error(t)},onDeleteSelection:function(){this.designService.DeleteSelection()},save:function(){console.log(this.designService.RootDesigner.XmlNode.ownerDocument);var e=this.target,t=[e.Type,e.ID,this.designService.GetXmlString()],n=this;$runtime.channel.invoke("sys.DesignService.SaveModel",t).then((function(e){n.$message.success("Save Report succeed.")})).catch((function(e){n.$message.error("Save error: "+e)}))}}},Ee=Re,je=(n("65c3"),Object(F["a"])(Ee,a,o,!1,null,"51efe4b2",null));t["default"]=je.exports}}]);