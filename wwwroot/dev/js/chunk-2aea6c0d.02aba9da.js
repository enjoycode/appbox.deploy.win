(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2aea6c0d"],{bcea:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("d225"),i=n("b0b4"),o=n("308d"),a=n("6bb5"),s=n("2a88"),l=n("4e2b"),u=n("2de8"),h=n("0c36"),c=function(e){function t(){return Object(r["a"])(this,t),Object(o["a"])(this,Object(a["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(i["a"])(t,[{key:"Paint",value:function(e){e.save(),e.beginPath(),e.rect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.clip(),e.strokeStyle="rgb(173,219,241)",e.lineWidth=1,e.strokeRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height);var t=this.GetPropertyString("Value","");if(t.length>0){e.font=this.Style.PaintFont,e.fillStyle="black";var n=0;this.Style.TextAlign===h["a"].Center?(e.textAlign="center",n=this.Bounds.X+this.Bounds.Width/2):this.Style.TextAlign===h["a"].Right?(e.textAlign="right",n=this.Bounds.Right-2):(e.textAlign="left",n=this.Bounds.X+2);var r=0;this.Style.VerticalAlign===h["b"].Middle?(e.textBaseline="middle",r=this.Bounds.Y+this.Bounds.Height/2):this.Style.VerticalAlign==h["b"].Bottom?(e.textBaseline="bottom",r=this.Bounds.Bottom-2):(e.textBaseline="top",r=this.Bounds.Y+2),e.fillText(t,n,r)}e.restore()}},{key:"getPropertyItems",value:function(){var e=this,n=Object(s["a"])(Object(a["a"])(t.prototype),"getPropertyItems",this).call(this);return n.splice(0,0,{name:"Common",items:[{title:"Value",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyString("Value","")},setter:function(t){return e.SetPropertyString("Value",t,!0)}},{title:"CanGrow",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("CanGrow",!1)},setter:function(t){return e.SetPropertyBool("CanGrow",t)}},{title:"CanShrink",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("CanShrink",!1)},setter:function(t){return e.SetPropertyBool("CanShrink",t)}}]}),n}}]),t}(u["a"])},f1b0:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%",width:"100%"}},[n("design-view",{ref:"designView",attrs:{background:"lightgray"},on:{ready:e.onDesignViewReady}})],1)},i=[],o=n("c34c"),a=(n("ac4d"),n("8a81"),n("ac6a"),n("d225")),s=n("b0b4"),l=n("2de8"),u=n("308d"),h=n("6bb5"),c=n("4e2b"),d=n("ffb8"),g=n("a374"),f=n("fe0c"),y=n("1fb1"),v=function(e){function t(){var e;return Object(a["a"])(this,t),e=Object(u["a"])(this,Object(h["a"])(t).apply(this,arguments)),e.anchorSize=6,e.anchorLocation=y["a"].None,e}return Object(c["a"])(t,e),Object(s["a"])(t,[{key:"OnRender",value:function(e){e.strokeStyle="darkgray",e.lineWidth=2,e.strokeRect(-3,-3,this.Target.Bounds.Width+6,this.Target.Bounds.Height+6),this.DrawAnchor(e,this.BottomCenter)}},{key:"DrawAnchor",value:function(e,t){e.fillStyle="white",e.fillRect(t.X,t.Y,t.Width,t.Height),e.strokeStyle="black",e.lineWidth=1,e.strokeRect(t.X,t.Y,t.Width,t.Height)}},{key:"HitTest",value:function(e){var t="";return this.BottomCenter.Contains(e.X,e.Y)?(this.anchorLocation=y["a"].BottomCenter,t="s-resize"):this.anchorLocation=y["a"].None,this.anchorLocation!=y["a"].None?[!0,t]:[!1,t]}},{key:"OnMouseMove",value:function(e){this.Target.Resize(this.anchorLocation,e.DeltaX,e.DeltaY)}},{key:"OnMouseUp",value:function(e){this.Target.OnEndResize()}},{key:"BottomCenter",get:function(){return new g["a"]((this.Target.Bounds.Width-this.anchorSize)/2,this.Target.Bounds.Height,this.anchorSize,this.anchorSize)}}]),t}(f["a"]),m=n("b7c5"),S=n("8500"),P=n("bcea"),p=n("a2ee"),b=function(e){function t(e,n,r){var i;Object(a["a"])(this,t),i=Object(u["a"])(this,Object(h["a"])(t).call(this,e)),i._bounds=new g["a"](0,0,0,0);var o=i.TryGetSize("Height",200);i._bounds=new g["a"](0,r,n,o);var s=p["a"].GetNamedChildNode(i.xmlNode,"ReportItems");if(s){var l=!0,c=!1,d=void 0;try{for(var f,y=s.childNodes[Symbol.iterator]();!(l=(f=y.next()).done);l=!0){var v=f.value;if(v.nodeType===Node.ELEMENT_NODE)switch(v.nodeName){case"Textbox":i.AddItem(new P["a"](v));break;default:console.warn("未实现");break}}}catch(m){c=!0,d=m}finally{try{l||null==y.return||y.return()}finally{if(c)throw d}}}return i}return Object(c["a"])(t,e),Object(s["a"])(t,[{key:"SetBounds",value:function(e,t,n,r,i){if(i===m["a"].Height){var o=r-this._bounds.Height;if(this.Parent){this._bounds.Height=r;for(var a=-1,s=0;s<this.Parent.Items.length;s++){var l=this.Parent.Items[s];-1===a&&l===this&&(a=s),-1!==a&&s>a&&(l.Bounds.Y+=o)}this.Parent.Bounds.Height+=o}this.Surface&&this.Surface.Invalidate()}else console.warn("ReportSectionDesigner只支持设置高度值")}},{key:"OnEndResize",value:function(){this.SetPropertyRSize("Height",this.Bounds.Height),this.Surface&&this.Surface.PropertyPanel.refreshProperty("Height")}},{key:"Paint",value:function(e){if(e.save(),e.beginPath(),e.rect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.clip(),e.fillStyle="white",e.fillRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.strokeStyle="rgb(173,219,241)",e.lineWidth=1,e.strokeRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),this.Items){e.translate(this.Bounds.X,this.Bounds.Y);var t=!0,n=!1,r=void 0;try{for(var i,o=this.Items[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.Paint(e)}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}e.translate(-this.Bounds.X,-this.Bounds.Y)}e.restore()}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Height",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("Height","0mm")},setter:function(t){return e.SetPropertyRSize("Height",t)}}]}];return"Body"!==this.getPropertyOwnerType()&&(t[0].items.push({title:"PrintOnFirstPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnFirstPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnFirstPage",t)}}),t[0].items.push({title:"PrintOnLastPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnLastPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnLastPage",t)}})),t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){this.SetBounds(e.X,e.Y,e.Width,e.Height,m["a"].All)}},{key:"IsContainer",get:function(){return!0}},{key:"Behavior",get:function(){return S["a"].CanResize}},{key:"SelectionAdorner",get:function(){return!this._selectionAdorner&&this.Surface&&(this._selectionAdorner=new v(this.Surface.Adorners,this)),this._selectionAdorner}}]),t}(d["a"]),B=function(e){function t(e){var n;Object(a["a"])(this,t),n=Object(u["a"])(this,Object(h["a"])(t).call(this,e)),n._bounds=new g["a"](0,0,0,0);var r=0,i=n.TryGetSize("PageWidth",400),o=p["a"].GetNamedChildNode(n.xmlNode,"PageHeader");if(o){var s=new b(o,i,r);n.AddItem(s),r+=s.Bounds.Height}var l=p["a"].GetNamedChildNode(n.xmlNode,"Body");if(l){var c=new b(l,i,r);n.AddItem(c),r+=c.Bounds.Height}var d=p["a"].GetNamedChildNode(n.xmlNode,"PageFooter");if(d){var f=new b(d,i,r);n.AddItem(f),r+=f.Bounds.Height}return n._bounds=new g["a"](8,8,i,r),n}return Object(c["a"])(t,e),Object(s["a"])(t,[{key:"SetBounds",value:function(e,t,n,r,i){}},{key:"Paint",value:function(e){if(this.Items){var t=!0,n=!1,r=void 0;try{for(var i,o=this.Items[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.Paint(e)}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"OnChangePageWidth",value:function(e){this._bounds.Width=p["a"].SizeToPixel(e);var t=!0,n=!1,r=void 0;try{for(var i,o=this.Items[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.Bounds.Width=this._bounds.Width}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.Surface.Invalidate()}},{key:"OnChangePageHeight",value:function(e){}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"PageWidth",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageWidth","200mm")},setter:function(t){e.SetPropertyRSize("PageWidth",t),e.OnChangePageWidth(t)}},{title:"PageHeight",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageHeight","150mm")},setter:function(t){e.SetPropertyRSize("PageHeight",t),e.OnChangePageHeight(t)}}]}];return t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){}},{key:"IsContainer",get:function(){return!0}}]),t}(d["a"]),C=function(){function e(t,n,r){Object(a["a"])(this,e),this._surface=t,this._channel=n,this._modelId=r,this._surface.DesignService=this}return Object(s["a"])(e,[{key:"loadXMLString",value:function(e){try{var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}catch(r){try{var n=new DOMParser;return t=n.parseFromString(e,"text/xml"),t}catch(r){alert(r.message)}}return null}},{key:"GetXmlString",value:function(){var e=this._rootDesigner.XmlNode.ownerDocument;return(new XMLSerializer).serializeToString(e)}},{key:"LoadDesignersFromServer",value:function(e){var t="<Report>";t+="<PageWidth>200mm</PageWidth>",t+="<PageHeight>140mm</PageHeight>",t+="<PageHeader>",t+="<Height>20mm</Height>",t+="<ReportItems>",t+='<Textbox Name="Textbox1">',t+="<Left>50pt</Left>",t+="<Top>10pt</Top>",t+="<Width>100pt</Width>",t+="<Height>30pt</Height>",t+="<Value>测试报表 Hello Future! 1234567890</Value>",t+="</Textbox>",t+="</ReportItems>",t+="</PageHeader>",t+="<Body>",t+="<Height>40mm</Height>",t+="</Body>",t+="<PageFooter>",t+="<Height>15mm</Height>",t+="</PageFooter>",t+="</Report>";var n=this.loadXMLString(t),r=n.getElementsByTagName("Report")[0],i=new B(r);this._rootDesigner=i,this._surface.AddItem(this._rootDesigner),this._surface.PropertyPanel.setPropertyOwner(this._rootDesigner),this._surface.Invalidate()}},{key:"ChangeProperty",value:function(e,t,n,r){console.log("ReportDesignService.ChangeProperty: "+t,r)}},{key:"DeleteSelection",value:function(){var e=this._surface.SelectionService.SelectedItems;if(e&&0!==e.length){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a instanceof l["a"]&&!a.IsTableCell&&(a.Parent?a.Parent.RemoveItem(a):console.warn("待删除的元素无上级"))}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this._surface.SelectionService.ClearSelection()}}},{key:"TableOperation",value:function(t){var n=this._surface.SelectionService.SelectedItems;if("SplitCells"!=t)if("InsertRow"!=t)if("InsertColumn"!=t)if("MergeCells"!=t);else{if(n.length<=1)return;for(var r="",i=0;i<n.length;i++){var o=n[i];if(o instanceof l["a"]&&o.Parent){if(!o.IsTableCell)return;o.Cell&&(r+=o.ID+";")}}var a=n[0].Parent;a&&e.ChangeProperty(a,t,n.length,r)}else{if(1!=n.length)return;var s=n[0];if(s instanceof l["a"]&&s.Parent){if(!s.IsTableCell)return;s.Cell&&e.ChangeProperty(s.Parent,t,s.Cell.RI,s.Cell.CI)}}else{if(1!=n.length)return;var u=n[0];if(u instanceof l["a"]&&u.Parent){if(!u.IsTableCell)return;u.Cell&&e.ChangeProperty(u.Parent,t,u.Cell.RI,u.Cell.CI)}}else{if(1!=n.length)return;var h=n[0];if(h instanceof l["a"]&&h.Parent){if(!h.IsTableCell)return;h.Cell&&e.ChangeProperty(h.Parent,t,h.Cell.RI,h.Cell.CI)}}}},{key:"GetShapes",value:function(){return[]}},{key:"GetConnections",value:function(){return[]}},{key:"RootDesigner",get:function(){return this._rootDesigner}}],[{key:"ChangeProperty",value:function(e,t,n,r){e.Surface&&e.Surface.DesignService.ChangeProperty(e,t,n,r)}},{key:"LoopFindByID",value:function(t,n){if(t.ID===n)return t;if(t.Items)for(var r=null,i=0;i<t.Items.length;i++)if(r=e.LoopFindByID(t.Items[i],n),r)return r;return null}}]),e}(),k={components:{DesignView:o["a"]},props:{target:{type:Object,required:!0}},data:function(){return{designerType:"ReportDesigner",designService:null}},methods:{onDesignViewReady:function(){this.designService=new C(this.$refs.designView.designSurface,$runtime.channel,this.target.ID),this.designService.LoadDesignersFromServer(this.target.ID)},save:function(){console.log(this.designService.RootDesigner.XmlNode.ownerDocument)},DeleteSelection:function(){this.designService.DeleteSelection()},MergeCells:function(){this.designService.TableOperation("MergeCells")},SplitCells:function(){this.designService.TableOperation("SplitCells")},InsertRow:function(){this.designService.TableOperation("InsertRow")},InsertColumn:function(){this.designService.TableOperation("InsertColumn")}}},I=k,O=n("2877"),w=Object(O["a"])(I,r,i,!1,null,null,null);t["default"]=w.exports}}]);