(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-392a9212"],{"65c3":function(e,t,n){"use strict";var i=n("b5e5"),r=n.n(i);r.a},b5e5:function(e,t,n){},e7f9:function(e,t,n){"use strict";var i=n("f2ca"),r=n.n(i);r.a},f1b0:function(e,t,n){"use strict";n.r(t);var i,r,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100%"}},[n("div",{staticClass:"header"},[n("el-radio-group",{staticStyle:{"margin-left":"40px"},attrs:{fill:"#0994ff",size:"small"},model:{value:e.activeView,callback:function(t){e.activeView=t},expression:"activeView"}},e._l(e.views,(function(t){return n("el-radio-button",{key:t.label,attrs:{label:t.label}},[e._v(e._s(t.title))])})),1),e._v(" "),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Insert"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"ICL"}},[e._v("Column Left")]),n("el-dropdown-item",{attrs:{command:"ICR"}},[e._v("Column Right")]),n("el-dropdown-item",{attrs:{command:"IRA",divided:""}},[e._v("Row Above")]),n("el-dropdown-item",{attrs:{command:"IRB"}},[e._v("Row Below")])],1)],1),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Delete"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"DC"}},[e._v("Column")]),n("el-dropdown-item",{attrs:{command:"DR"}},[e._v("Row")])],1)],1),n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],on:{command:e.onTableCommand}},[n("el-button",{attrs:{size:"small",icon:"fas fa-table"}},[e._v(" Cells"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"CM"}},[e._v("Merge")]),n("el-dropdown-item",{attrs:{command:"CS"}},[e._v("Split")])],1)],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],attrs:{size:"small",icon:"fas fa-times fa-fw"},on:{click:e.onDeleteSelection}},[e._v("Delete Selection")])],1),n("div",{staticClass:"content"},[n("design-view",{directives:[{name:"show",rawName:"v-show",value:"design"===e.activeView,expression:"activeView==='design'"}],ref:"designView",attrs:{background:"lightgray"},on:{ready:e.onDesignViewReady}}),"preview"===e.activeView?n("pdf-viewer",{attrs:{file:"/api/design/report/"+e.target.ID}}):e._e()],1)])},a=[],s=n("c34c"),l=(n("ac4d"),n("8a81"),n("ac6a"),n("d225")),u=n("b0b4"),d=n("2de8"),c=n("308d"),h=n("6bb5"),f=n("013f"),v=n("4e2b"),g=n("ffb8"),m=n("a374"),y=n("fe0c"),p=n("1fb1"),b=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(c["a"])(this,Object(h["a"])(t).apply(this,arguments)),e.anchorSize=6,e.anchorLocation=p["a"].None,e}return Object(v["a"])(t,e),Object(u["a"])(t,[{key:"OnRender",value:function(e){e.strokeStyle="darkgray",e.lineWidth=2,e.strokeRect(-3,-3,this.Target.Bounds.Width+6,this.Target.Bounds.Height+6),this.DrawAnchor(e,this.BottomCenter)}},{key:"DrawAnchor",value:function(e,t){e.fillStyle="white",e.fillRect(t.X,t.Y,t.Width,t.Height),e.strokeStyle="black",e.lineWidth=1,e.strokeRect(t.X,t.Y,t.Width,t.Height)}},{key:"HitTest",value:function(e){var t="";return this.BottomCenter.Contains(e.X,e.Y)?(this.anchorLocation=p["a"].BottomCenter,t="s-resize"):this.anchorLocation=p["a"].None,this.anchorLocation!=p["a"].None?[!0,t]:[!1,t]}},{key:"OnMouseMove",value:function(e){this.Target.Resize(this.anchorLocation,e.DeltaX,e.DeltaY)}},{key:"OnMouseUp",value:function(e){this.Target.OnEndResize()}},{key:"BottomCenter",get:function(){return new m["a"]((this.Target.Bounds.Width-this.anchorSize)/2,this.Target.Bounds.Height,this.anchorSize,this.anchorSize)}}]),t}(y["a"]),w=n("b7c5"),S=n("8500"),_=n("a2ee"),C=n("26e6"),N=function(e){function t(e,n,i){var r;Object(l["a"])(this,t),r=Object(c["a"])(this,Object(h["a"])(t).call(this,e)),r._bounds=new m["a"](0,0,0,0);var o=_["a"].TryGetSize(r.xmlNode,"Height",200);r._bounds=new m["a"](0,i,n,o);var a=_["a"].GetNamedChildNode(r.xmlNode,"ReportItems");if(a){var s=!0,u=!1,d=void 0;try{for(var f,v=a.childNodes[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){var g=f.value;if(g.nodeType===Node.ELEMENT_NODE){var y=C["a"].Make(g,null);y&&r.AddItem(y)}}}catch(p){u=!0,d=p}finally{try{s||null==v.return||v.return()}finally{if(u)throw d}}}return r}return Object(v["a"])(t,e),Object(u["a"])(t,[{key:"SetBounds",value:function(e,t,n,i,r){if(r===w["a"].Height){var o=i-this._bounds.Height;if(this.Parent){this._bounds.Height=i;for(var a=-1,s=0;s<this.Parent.Items.length;s++){var l=this.Parent.Items[s];-1===a&&l===this&&(a=s),-1!==a&&s>a&&(l.Bounds.Y+=o)}this.Parent.Bounds.Height+=o}this.Surface&&this.Surface.Invalidate()}else console.warn("ReportSectionDesigner只支持设置高度值")}},{key:"OnEndResize",value:function(){this.SetPropertyRSize("Height",this.Bounds.Height),this.Surface&&this.Surface.PropertyPanel.refreshProperty("Height")}},{key:"Paint",value:function(e){if(e.save(),e.beginPath(),e.rect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.clip(),e.fillStyle="white",e.fillRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),e.strokeStyle="rgb(173,219,241)",e.lineWidth=1,e.strokeRect(this.Bounds.X,this.Bounds.Y,this.Bounds.Width,this.Bounds.Height),this.Items){e.translate(this.Bounds.X,this.Bounds.Y);var t=!0,n=!1,i=void 0;try{for(var r,o=this.Items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a.Paint(e)}}catch(s){n=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}e.translate(-this.Bounds.X,-this.Bounds.Y)}e.restore()}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Height",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("Height","0mm")},setter:function(t){return e.SetPropertyRSize("Height",t)}}]}];return"Body"!==this.getPropertyOwnerType()&&(t[0].items.push({title:"PrintOnFirstPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnFirstPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnFirstPage",t)}}),t[0].items.push({title:"PrintOnLastPage",readonly:!1,editor:"CheckBox",getter:function(){return e.GetPropertyBool("PrintOnLastPage",!0)},setter:function(t){return e.SetPropertyBool("PrintOnLastPage",t)}})),t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){this.SetBounds(e.X,e.Y,e.Width,e.Height,w["a"].All)}},{key:"IsContainer",get:function(){return!0}},{key:"Behavior",get:function(){return S["a"].CanResize}},{key:"SelectionAdorner",get:function(){return!this._selectionAdorner&&this.Surface&&(this._selectionAdorner=new b(this.Surface.Adorners,this)),this._selectionAdorner}}]),t}(g["a"]);(function(e){e[e["DataField"]=0]="DataField",e[e["EntityRef"]=2]="EntityRef",e[e["EntitySet"]=3]="EntitySet"})(i||(i={})),function(e){e[e["EntityId"]=0]="EntityId",e[e["String"]=1]="String",e[e["DateTime"]=2]="DateTime",e[e["UInt16"]=3]="UInt16",e[e["Int16"]=4]="Int16",e[e["UInt32"]=5]="UInt32",e[e["Int32"]=6]="Int32",e[e["UInt64"]=7]="UInt64",e[e["Int64"]=8]="Int64",e[e["Decimal"]=9]="Decimal",e[e["Boolean"]=10]="Boolean",e[e["Guid"]=11]="Guid",e[e["Byte"]=12]="Byte",e[e["Binary"]=13]="Binary",e[e["Enum"]=14]="Enum",e[e["Float"]=15]="Float",e[e["Double"]=16]="Double"}(r||(r={}));var D=function(){function e(t,n){Object(l["a"])(this,e),this._owner=t,this._node=n}return Object(u["a"])(e,[{key:"getPropertyOwnerType",value:function(){return"Field"}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Name",readonly:!1,editor:"TextBox",getter:function(){return e.Name},setter:function(t){e.Name=t}},{title:"DataField",readonly:!1,editor:"TextBox",getter:function(){return e.DataField},setter:function(t){e.DataField=t}},{title:"TypeName",readonly:!1,editor:"Select",options:x.TypeNames,getter:function(){return e.TypeName},setter:function(t){e.TypeName=t}}]}];return t}},{key:"Node",get:function(){return this._node}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"DataField",get:function(){var e=_["a"].GetNamedChildNode(this._node,"DataField");return e?e.textContent:""},set:function(e){var t=_["a"].GetOrCreateChildNode(this._node,"DataField");t.textContent=e}},{key:"TypeName",get:function(){var e=_["a"].GetNamedChildNode(this._node,"TypeName");return e?e.textContent:""},set:function(e){var t=_["a"].GetOrCreateChildNode(this._node,"TypeName");t.textContent=e}}]),e}(),k=function(){function e(t){Object(l["a"])(this,e),this._node=t}return Object(u["a"])(e,[{key:"CommandText",get:function(){var e=_["a"].GetNamedChildNode(this._node,"CommandText");return e?e.textContent:""},set:function(e){var t=_["a"].GetOrCreateChildNode(this._node,"CommandText");t.textContent=e}}]),e}(),I=function(){function e(t,n){if(Object(l["a"])(this,e),this._fields=[],this._owner=t,this._node=n,this.Query=new k(_["a"].GetOrCreateChildNode(this._node,"Query")),this._fieldsNode=_["a"].GetNamedChildNode(this._node,"Fields"),this._fieldsNode){var i=!0,r=!1,o=void 0;try{for(var a,s=this._fieldsNode.childNodes[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;this._fields.push(new D(this,u))}}catch(d){r=!0,o=d}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}}return Object(u["a"])(e,[{key:"AddField",value:function(e,t,n){this._fieldsNode||(this._fieldsNode=_["a"].CreateChildNode(this._node,"Fields"));var i=_["a"].CreateChildNode(this._fieldsNode,"Field"),r=new D(this,i);r.Name=e,r.DataField=t,r.TypeName=n,this._fields.push(r)}},{key:"RemoveField",value:function(e){this._fieldsNode.removeChild(e.Node),this._fields.splice(this._fields.indexOf(e),1),0===this._fields.length&&(this._node.removeChild(this._fieldsNode),this._fieldsNode=null)}},{key:"getPropertyOwnerType",value:function(){return"DataSet"}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"Name",readonly:!1,editor:"TextBox",getter:function(){return e.Name},setter:function(t){e.Name=t}},{title:"QueryCommand",readonly:!1,editor:"TextBox",getter:function(){return e.QueryCommand},setter:function(t){e.QueryCommand=t}}]}];return t}},{key:"Node",get:function(){return this._node}},{key:"Fields",get:function(){return this._fields}},{key:"Name",get:function(){return this._node.getAttribute("Name")},set:function(e){this._node.setAttribute("Name",e)}},{key:"QueryCommand",get:function(){return this.Query.CommandText},set:function(e){this.Query.CommandText=e}}]),e}(),x=function(){function e(t){if(Object(l["a"])(this,e),this._items=[],this._owner=t,this._node=_["a"].GetNamedChildNode(t.XmlNode,"DataSets"),this._node){var n=!0,i=!1,r=void 0;try{for(var o,a=this._node.childNodes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._items.push(new I(this,s))}}catch(u){i=!0,r=u}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}return Object(u["a"])(e,[{key:"Add",value:function(t,n){this._node||(this._node=_["a"].CreateChildNode(this._owner.XmlNode,"DataSets"));var r=_["a"].CreateChildNode(this._node,"DataSet"),o=new I(this,r);if(t&&(o.Name=t),n){var a=!0,s=!1,l=void 0;try{for(var u,d=n[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var c=u.value;c.Type===i.DataField&&o.AddField(c.Name,c.Name,e.ToTypeName(c.DataType))}}catch(h){s=!0,l=h}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}}this._items.push(o)}},{key:"Remove",value:function(e){this._node.removeChild(e.Node),this._items.splice(this._items.indexOf(e),1),0===this._items.length&&(this._owner.XmlNode.removeChild(this._node),this._node=null)}},{key:"Items",get:function(){return this._items}}],[{key:"ToTypeName",value:function(e){switch(e){case r.Enum:return"Int32";case r.String:return"String";case r.Boolean:return"Boolean";case r.DateTime:return"DateTime";case r.Decimal:return"Decimal";case r.Byte:return"Byte";case r.Int16:return"Int16";case r.Int32:return"Int32";case r.Int64:return"Int64";case r.UInt16:return"UInt16";case r.UInt32:return"UInt32";case r.UInt64:return"UInt64";case r.Float:return"Float";case r.Double:return"Double";default:return"Object"}}}]),e}();x.TypeNames=["String","Boolean","DateTime","Decimal","Byte","Int16","Int32","Int64","UInt16","UInt32","UInt64","Float","Double"];var P=function(e){function t(e){var n;Object(l["a"])(this,t),n=Object(c["a"])(this,Object(h["a"])(t).call(this,e)),n._bounds=new m["a"](0,0,0,0),n._datasets=new x(Object(f["a"])(n));var i=0,r=_["a"].TryGetSize(n.xmlNode,"PageWidth",400),o=_["a"].GetNamedChildNode(n.xmlNode,"PageHeader");if(o){var a=new N(o,r,i);n.AddItem(a),i+=a.Bounds.Height}var s=_["a"].GetNamedChildNode(n.xmlNode,"Body");if(s){var u=new N(s,r,i);n.AddItem(u),i+=u.Bounds.Height}var d=_["a"].GetNamedChildNode(n.xmlNode,"PageFooter");if(d){var v=new N(d,r,i);n.AddItem(v),i+=v.Bounds.Height}return n._bounds=new m["a"](8,8,r,i),n}return Object(v["a"])(t,e),Object(u["a"])(t,[{key:"SetBounds",value:function(e,t,n,i,r){}},{key:"Paint",value:function(e){if(this.Items){var t=!0,n=!1,i=void 0;try{for(var r,o=this.Items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a.Paint(e)}}catch(s){n=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}}},{key:"GetDataSets",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var r,o=this._datasets.Items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;e.push(a.Name)}}catch(s){n=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return e}},{key:"OnChangePageWidth",value:function(e){this._bounds.Width=_["a"].SizeToPixel(e);var t=!0,n=!1,i=void 0;try{for(var r,o=this.Items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a.Bounds.Width=this._bounds.Width}}catch(s){n=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this.Surface.Invalidate()}},{key:"OnChangePageHeight",value:function(e){}},{key:"getPropertyItems",value:function(){var e=this,t=[{name:"Common",items:[{title:"PageWidth",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageWidth","200mm")},setter:function(t){e.SetPropertyRSize("PageWidth",t),e.OnChangePageWidth(t)}},{title:"PageHeight",readonly:!1,editor:"TextBox",getter:function(){return e.GetPropertyRSize("PageHeight","150mm")},setter:function(t){e.SetPropertyRSize("PageHeight",t),e.OnChangePageHeight(t)}},{title:"DataSets",readonly:!0,editor:"ReportDataSets",getter:function(){return e},setter:function(e){}}]}];return t}},{key:"Bounds",get:function(){return this._bounds},set:function(e){}},{key:"IsContainer",get:function(){return!0}},{key:"DataSets",get:function(){return this._datasets}}]),t}(g["a"]),B=n("8cde"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-input",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},T=[],R={props:{target:{type:Object}},data:function(){return{value:""}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},H=R,F=n("2877"),j=Object(F["a"])(H,O,T,!1,null,null,null),E=j.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-checkbox",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},$=[],A={props:{target:{type:Object}},data:function(){return{value:!1}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},G=A,z=Object(F["a"])(G,V,$,!1,null,null,null),W=z.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",{attrs:{readonly:e.target.readonly},on:{change:e.onChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.target.options,(function(e){return n("el-option",{key:e,attrs:{value:e}})})),1)},M=[],X={props:{target:{type:Object}},data:function(){return{value:""}},watch:{target:function(e){this.value=e.getter()}},methods:{onChange:function(){this.target.readonly||this.target.setter(this.value)},refresh:function(){this.$set(this,"value",this.target.getter())}},mounted:function(){this.value=this.target.getter()}},U=X,Y=Object(F["a"])(U,L,M,!1,null,null,null),Q=Y.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:e.openEditor}},[e._v("...")]),n("el-dialog",{attrs:{"before-close":e.closingEditor,title:"Report DataSets",visible:e.dlgVisible,width:"600px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",[n("el-select",{attrs:{"value-key":"ID",filterable:"",placeholder:" "},model:{value:e.entityModel,callback:function(t){e.entityModel=t},expression:"entityModel"}},e._l(e.allEntities,(function(t){return n("el-option-group",{key:t.ID,attrs:{label:t.Text,value:t.ID}},e._l(t.Nodes,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e}})})),1)})),1),n("el-button-group",[n("el-button",{on:{click:e.onAddDS}},[e._v("Add")]),n("el-button",{on:{click:e.onDelDS}},[e._v("Remove")])],1),e._v(" "),n("el-button-group",[n("el-button",{on:{click:e.onAddField}},[e._v("Add Field")]),n("el-button",{on:{click:e.onDelField}},[e._v("Remove Field")])],1),n("br"),n("br"),n("el-row",{staticStyle:{height:"260px"}},[n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("el-tree",{staticStyle:{height:"100%"},attrs:{data:e.datasets,props:e.treeOpts},on:{"current-change":e.onCurrentChange}})],1),n("el-col",{staticStyle:{height:"100%"},attrs:{span:12}},[n("property-panel",{ref:"props"})],1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},q=[],K=n("eb37"),Z=n("ff57"),ee={components:{PropertyPanel:K["a"]},props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,allEntities:[],entityModel:null,currentNode:null,datasets:[],treeOpts:{label:"Name",children:"Fields"}}},watch:{target:function(e){this.value=e.getter()}},methods:{openEditor:function(){this.dlgVisible=!0,this.$set(this,"datasets",this.value.DataSets.Items)},closingEditor:function(e){e()},onAddDS:function(){var e=this,t=this;this.entityModel&&$runtime.channel.invoke("sys.DesignService.GetEntityModel",[this.entityModel.ID]).then((function(n){t.value.DataSets.Add(e.entityModel.Name,n.Members)})).catch((function(e){console.warn(e)}))},onDelDS:function(){this.currentNode&&1===this.currentNode.level?(this.value.DataSets.Remove(this.currentNode.data),this.currentNode=null,this.$refs.props.setPropertyOwner(null)):this.$message.warning("Please select a DataSet first")},onAddField:function(){var e=this;this.currentNode&&1===this.currentNode.level?this.$prompt("DataField Name","Input",{confirmButtonText:"Ok",cancelButtonText:"Cancel"}).then((function(t){var n=t.value;e.currentNode.data.AddField(n,n,"String")})).catch((function(){})):this.$message.warning("Please select a DataSet first")},onDelField:function(){this.currentNode&&2===this.currentNode.level?(this.currentNode.parent.data.RemoveField(this.currentNode.data),this.currentNode=null,this.$refs.props.setPropertyOwner(null)):this.$message.warning("Please select a Field first")},onCurrentChange:function(e,t){this.currentNode=t,this.$refs.props.DesignService||(this.$refs.props.DesignService=this.value.Surface.DesignService),this.$refs.props.setPropertyOwner(e)}},mounted:function(){this.value=this.target.getter(),Z["a"].tree.getAllEntityNodes(this.allEntities,null)}},te=ee,ne=Object(F["a"])(te,J,q,!1,null,null,null),ie=ne.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{width:"100%"},on:{click:function(t){e.dlgVisible=!0}}},[e._v("...")]),n("el-dialog",{attrs:{title:"Border Style",visible:e.dlgVisible,width:"400px"},on:{"update:visible":function(t){e.dlgVisible=t}}},[n("div",{staticClass:"rows"},e._l(e.borders,(function(t,i){return n("el-row",{key:t.pos,attrs:{gutter:8}},[n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v(e._s(t.pos)+":")]),n("el-col",{attrs:{span:8}},[n("el-select",{on:{change:function(t){return e.changeStyle(i)}},model:{value:t.style,callback:function(n){e.$set(t,"style",n)},expression:"item.style"}},e._l(e.borderStyles,(function(e){return n("el-option",{key:e,attrs:{value:e}})})),1)],1),n("el-col",{attrs:{span:10}},[n("el-input-number",{attrs:{min:.25,max:20},model:{value:t.width,callback:function(n){e.$set(t,"width",n)},expression:"item.width"}})],1),n("el-col",{attrs:{span:2}},[n("el-color-picker",{model:{value:t.color,callback:function(n){e.$set(t,"color",n)},expression:"item.color"}})],1)],1)})),1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dlgVisible=!1}}},[e._v("Done")])],1)])],1)},oe=[],ae={props:{target:{type:Object}},data:function(){return{value:null,dlgVisible:!1,borderStyles:["None","Dashed","Solid"],borders:[{pos:"Default",style:"None",width:1,color:"#000000"},{pos:"Left",style:"None",width:1,color:"#000000"},{pos:"Top",style:"None",width:1,color:"#000000"},{pos:"Right",style:"None",width:1,color:"#000000"},{pos:"Bottom",style:"None",width:1,color:"#000000"}]}},watch:{target:function(e){this.value=e.getter()}},methods:{refresh:function(){this.$set(this,"value",this.target.getter())},changeStyle:function(e){if(0===e)for(var t=1;t<this.borders.length;t++)this.borders[t].style=this.borders[0].style;else this.borders[0].style="";this.value.SetBorderStyle(this.borders[e].pos,this.borders[e].style)}},mounted:function(){this.value=this.target.getter()}},se=ae,le=(n("e7f9"),Object(F["a"])(se,re,oe,!1,null,"cb244e14",null)),ue=le.exports,de=function(){function e(t,n,i){Object(l["a"])(this,e),this._surface=t,this._channel=n,this._modelId=i,this._surface.DesignService=this,this._surface.ToolboxService.Toolbox=new B["a"],this._surface.PropertyPanel.DesignService=this}return Object(u["a"])(e,[{key:"GetXmlString",value:function(){var e=this._rootDesigner.XmlNode.ownerDocument;return(new XMLSerializer).serializeToString(e)}},{key:"LoadDesigners",value:function(e){var t=_["a"].LoadXMLString(e),n=t.getElementsByTagName("Report")[0],i=new P(n);this._rootDesigner=i,this._surface.AddItem(this._rootDesigner),this._surface.PropertyPanel.setPropertyOwner(this._rootDesigner),this._surface.Invalidate()}},{key:"ChangeProperty",value:function(e,t,n,i){console.log("ReportDesignService.ChangeProperty: "+t,i)}},{key:"DeleteSelection",value:function(){var e=this._surface.SelectionService.SelectedItems;if(e&&0!==e.length){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;a instanceof d["a"]&&!a.IsTableCell&&(a.Parent?a.Parent.RemoveItem(a):console.warn("待删除的元素无上级"))}}catch(s){n=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}this._surface.SelectionService.ClearSelection()}}},{key:"InsertColumn",value:function(e){var t=this._surface.SelectionService.SelectedItems;if(0===t.length||!(t[0]instanceof d["a"])||!t[0].IsTableCell)return"Please select some TableCell first.";var n=t[0],i=n.Cell.Row,r=n.Cell.ColIndex;e||r++,i.Owner.Table.InsertColumn(r,100),i.Owner.Table.Parent.Invalidate()}},{key:"DeleteColumn",value:function(){var e=this._surface.SelectionService.SelectedItems;if(0===e.length||!(e[0]instanceof d["a"])||!e[0].IsTableCell)return"Please select some TableCell first.";var t=e[0],n=t.Cell.Row.Owner.Table;if(1===n.Columns.length)return"Cann't delete last column.";var i=t.Cell.ColIndex;t.Cell.Row.Owner.Table.DeleteColumn(i),n.Parent.Invalidate()}},{key:"GetShapes",value:function(){return[]}},{key:"GetConnections",value:function(){return[]}},{key:"GetPropertyEditor",value:function(t){return e._editors[t]}},{key:"Surface",get:function(){return this._surface}},{key:"RootDesigner",get:function(){return this._rootDesigner}}]),e}();de._editors={TextBox:E,CheckBox:W,Select:Q,ReportDataSets:ie,BorderStyle:ue};var ce={components:{DesignView:s["a"]},props:{target:{type:Object,required:!0}},data:function(){return{activeView:"design",views:[{label:"design",title:"Design"},{label:"preview",title:"Preview"}],designerType:"ReportDesigner",designService:null}},methods:{onDesignViewReady:function(){if(this.designService=new de(this.$refs.designView.designSurface,$runtime.channel,this.target.ID),0===this.target.ID){var e="<Report>";return e+="<PageWidth>200mm</PageWidth>",e+="<PageHeight>140mm</PageHeight>",e+="<PageHeader>",e+="<Height>20mm</Height>",e+="<ReportItems>",e+='<Textbox Name="Textbox1">',e+="<Left>50pt</Left>",e+="<Top>10pt</Top>",e+="<Width>100pt</Width>",e+="<Height>30pt</Height>",e+="<Value>测试报表 Hello Future! 1234567890</Value>",e+="</Textbox>",e+="</ReportItems>",e+="</PageHeader>",e+="<Body>",e+="<Height>40mm</Height>",e+="</Body>",e+="<PageFooter>",e+="<Height>15mm</Height>",e+="</PageFooter>",e+="</Report>",void this.designService.LoadDesigners(e)}var t=this;$runtime.channel.invoke("sys.DesignService.OpenReportModel",[this.target.ID]).then((function(e){t.designService.LoadDesigners(e)})).catch((function(e){t.$message.error("Open Report error:"+e)}))},onTableCommand:function(e){var t=null;switch(e){case"ICL":t=this.designService.InsertColumn(!0);break;case"ICR":t=this.designService.InsertColumn(!1);break;case"DC":t=this.designService.DeleteColumn();break;default:break}t&&this.$message.error(t)},onDeleteSelection:function(){this.designService.DeleteSelection()},save:function(){console.log(this.designService.RootDesigner.XmlNode.ownerDocument);var e=this.target,t=[e.Type,e.ID,this.designService.GetXmlString()],n=this;$runtime.channel.invoke("sys.DesignService.SaveModel",t).then((function(e){n.$message.success("Save Report succeed.")})).catch((function(e){n.$message.error("Save error: "+e)}))}}},he=ce,fe=(n("65c3"),Object(F["a"])(he,o,a,!1,null,"51efe4b2",null));t["default"]=fe.exports},f2ca:function(e,t,n){}}]);